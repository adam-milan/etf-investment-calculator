<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美股ETF定期定額投資計算器</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <style>
        /* 保留之前的 CSS 樣式 */
        /* ... */
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            font-size: 14px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: var(--primary-color);
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        @media (max-width: 768px) {
            table {
                font-size: 12px;
            }
            th, td {
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>美股ETF定期定額投資計算器</h1>
        
        <!-- 保留之前的介紹部分 -->
        
        <div class="card">
            <form id="investmentForm">
                <!-- 保留之前的表單內容 -->
                <div>
                    <label for="etfSelect">選擇ETF:</label>
                    <select id="etfSelect">
                        <option value="VT">VT - Vanguard Total World Stock ETF (全球股票市場指數)</option>
                        <option value="VTI">VTI - Vanguard Total Stock Market ETF (全美國股市指數)</option>
                        <option value="VOO">VOO - Vanguard S&P 500 ETF (追蹤標準普爾500指數)</option>
                        <option value="VIG">VIG - Vanguard Dividend Appreciation ETF (股息增長指數)</option>
                        <option value="VUG">VUG - Vanguard Growth ETF (大型成長股指數)</option>
                        <option value="VTV">VTV - Vanguard Value ETF (大型價值股指數)</option>
                        <option value="QQQ">QQQ - Invesco QQQ Trust (納斯達克科技股指數)</option>
                        <option value="SMH">SMH - VanEck Semiconductor ETF (追蹤半導體產業)</option>
                        <option value="AOA">AOA - iShares Core Aggressive Allocation ETF (積極股債配置)</option>
                    </select>
                </div>
                
                <button type="submit">計算</button>
            </form>

            <div id="result"></div>
        </div>

        <div class="card">
            <div id="chartContainer">
                <canvas id="investmentChart"></canvas>
            </div>
        </div>
        
        <div class="card">
            <table id="etfComparison">
                <thead>
                    <tr>
                        <th>ETF</th>
                        <th>名稱</th>
                        <th>費用率</th>
                        <th>市值排名</th>
                        <th>年化報酬率</th>
                        <th>波動率(標準差)</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 表格內容將由JavaScript動態填充 -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const etfData = {
            VT: {
                name: "Vanguard Total World Stock ETF (全球股票市場指數)",
                annualReturn: 0.0943,
                expense: 0.0007,
                marketCapRank: 22,
                volatility: 0.1523
            },
            VTI: {
                name: "Vanguard Total Stock Market ETF (全美國股市指數)",
                annualReturn: 0.1023,
                expense: 0.0003,
                marketCapRank: 3,
                volatility: 0.1612
            },
            VOO: {
                name: "Vanguard S&P 500 ETF (追蹤標準普爾500指數)",
                annualReturn: 0.1131,
                expense: 0.0003,
                marketCapRank: 2,
                volatility: 0.1589
            },
            VIG: {
                name: "Vanguard Dividend Appreciation ETF (股息增長指數)",
                annualReturn: 0.0972,
                expense: 0.0006,
                marketCapRank: 12,
                volatility: 0.1432
            },
            VUG: {
                name: "Vanguard Growth ETF (大型成長股指數)",
                annualReturn: 0.1256,
                expense: 0.0004,
                marketCapRank: 9,
                volatility: 0.1823
            },
            VTV: {
                name: "Vanguard Value ETF (大型價值股指數)",
                annualReturn: 0.0897,
                expense: 0.0004,
                marketCapRank: 13,
                volatility: 0.1512
            },
            QQQ: {
                name: "Invesco QQQ Trust (納斯達克科技股指數)",
                annualReturn: 0.1568,
                expense: 0.0020,
                marketCapRank: 4,
                volatility: 0.2145
            },
            SMH: {
                name: "VanEck Semiconductor ETF (追蹤半導體產業)",
                annualReturn: 0.1723,
                expense: 0.0035,
                marketCapRank: 48,
                volatility: 0.2678
            },
            AOA: {
                name: "iShares Core Aggressive Allocation ETF (積極股債配置)",
                annualReturn: 0.0912,
                expense: 0.0015,
                marketCapRank: 1572,
                volatility: 0.1345
            }
        };

        let chart;

        document.getElementById('investmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const monthlyInvestment = parseFloat(document.getElementById('monthlyInvestment').value);
            const investmentPeriod = parseFloat(document.getElementById('investmentPeriod').value);
            const selectedETF = document.getElementById('etfSelect').value;
            
            const annualReturn = etfData[selectedETF].annualReturn - etfData[selectedETF].expense;
            const monthlyRate = annualReturn / 12;
            const totalMonths = investmentPeriod * 12;
            
            const futureValue = monthlyInvestment * ((Math.pow(1 + monthlyRate, totalMonths) - 1) / monthlyRate) * (1 + monthlyRate);
            
            const totalInvested = monthlyInvestment * totalMonths;
            const interestEarned = futureValue - totalInvested;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>投資結果</h3>
                <p>選擇的ETF: ${etfData[selectedETF].name}</p>
                <p>投資總額: ${totalInvested.toLocaleString()} 新台幣</p>
                <p>預估收益: ${interestEarned.toLocaleString()} 新台幣</p>
                <p>最終金額: ${futureValue.toLocaleString()} 新台幣</p>
                <p>年化報酬率: ${(annualReturn * 100).toFixed(2)}%</p>
                <p>波動率(標準差): ${(etfData[selectedETF].volatility * 100).toFixed(2)}%</p>
            `;

            updateChart(totalMonths, monthlyInvestment, monthlyRate);
        });

        function updateChart(totalMonths, monthlyInvestment, monthlyRate) {
            // 保留之前的圖表更新代碼
            // ...
        }

        function populateETFTable() {
            const tableBody = document.querySelector('#etfComparison tbody');
            for (const [key, value] of Object.entries(etfData)) {
                const row = tableBody.insertRow();
                row.insertCell(0).textContent = key;
                row.insertCell(1).textContent = value.name;
                row.insertCell(2).textContent = (value.expense * 100).toFixed(2) + '%';
                row.insertCell(3).textContent = value.marketCapRank;
                row.insertCell(4).textContent = (value.annualReturn * 100).toFixed(2) + '%';
                row.insertCell(5).textContent = (value.volatility * 100).toFixed(2) + '%';
            }
        }

        window.onload = function() {
            populateETFTable();
        };
    </script>
</body>
</html>
