<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美股ETF定期定額投資計算器</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            color: #333;
        }
        h1 {
            text-align: center;
        }
        .introduction, .etf-descriptions {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .introduction p, .introduction ul, .etf-descriptions p {
            margin-bottom: 10px;
        }
        .introduction ul {
            padding-left: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="number"], select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
        }
        #chartContainer {
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>美股ETF定期定額投資計算器</h1>
        
        <div class="introduction">
            <h3>什麼是ETF？</h3>
            <p>ETF（交易所交易基金）是一種投資工具，追蹤特定指數、行業、商品或其他資產，且ETF提供了一種簡單的方式來分散投資組合，同時保持較低的費用。</p>
            
            <h3>為什麼選擇定期定額投資？</h3>
            <p>定期定額投資是一種投資策略，投資者定期投入固定金額到選定的投資工具中。這種方法有以下優點：</p>
            <ul>
                <li>降低市場時機選擇的風險</li>
                <li>利用dollar-cost averaging（平均成本法）的優勢</li>
                <li>培養良好的長期投資習慣</li>
                <li>減少情緒化投資決策的影響</li>
            </ul>
            
            <p>請記住，這個計算器提供的是基於歷史數據的估算，實際投資結果可能會有所不同。投資前請務必進行充分的研究，並考慮諮詢專業的財務顧問。</p>
        </div>

        <form id="investmentForm">
            <label for="monthlyInvestment">每月投資金額 (新台幣):</label>
            <input type="number" id="monthlyInvestment" required>
            
            <label for="investmentPeriod">投資期間 (年):</label>
            <input type="number" id="investmentPeriod" required>
            
            <label for="etfSelect">選擇ETF:</label>
            <select id="etfSelect">
                <option value="VT">VT - Vanguard Total World Stock ETF</option>
                <option value="VTI">VTI - Vanguard Total Stock Market ETF</option>
                <option value="VOO">VOO - Vanguard S&P 500 ETF</option>
                <option value="QQQ">QQQ - Invesco QQQ Trust</option>
                <option value="SMH">SMH - VanEck Semiconductor ETF</option>
                <option value="AOA">AOA - iShares Core Aggressive Allocation ETF</option>
            </select>
            
            <button type="submit">計算</button>
        </form>

        <div class="etf-descriptions">
            <h3>ETF 說明：</h3>
            <p>VT - 全球股票市場指數</p>
            <p>VTI - 全美國股市指數</p>
            <p>VOO - 追蹤標準普爾500指數</p>
            <p>QQQ - 納斯達克科技股指數</p>
            <p>SMH - 追蹤半導體產業</p>
            <p>AOA - 積極股債配置</p>
        </div>

        <div id="etfDescription"></div>
        <div id="result"></div>
        <div id="chartContainer">
            <canvas id="investmentChart"></canvas>
        </div>
        
        <table id="etfComparison">
            <thead>
                <tr>
                    <th>ETF</th>
                    <th>名稱</th>
                    <th>費用率</th>
                    <th>市值排名</th>
                </tr>
            </thead>
            <tbody>
                <!-- 表格內容將由JavaScript動態填充 -->
            </tbody>
        </table>
    </div>

    <script>
        const etfData = {
            VT: {
                name: "Vanguard Total World Stock ETF",
                description: "VT - 全球股票市場指數",
                annualReturn: 0.0943,
                expense: 0.0007,
                marketCapRank: 25
            },
            VTI: {
                name: "Vanguard Total Stock Market ETF",
                description: "VTI - 全美國股市指數",
                annualReturn: 0.1023,
                expense: 0.0003,
                marketCapRank: 1
            },
            VOO: {
                name: "Vanguard S&P 500 ETF",
                description: "VOO - 追蹤標準普爾500指數",
                annualReturn: 0.1131,
                expense: 0.0003,
                marketCapRank: 2
            },
            QQQ: {
                name: "Invesco QQQ Trust",
                description: "QQQ - 納斯達克科技股指數",
                annualReturn: 0.1568,
                expense: 0.0020,
                marketCapRank: 5
            },
            SMH: {
                name: "VanEck Semiconductor ETF",
                description: "SMH - 追蹤半導體產業",
                annualReturn: 0.1723,
                expense: 0.0035,
                marketCapRank: 51
            },
            AOA: {
                name: "iShares Core Aggressive Allocation ETF",
                description: "AOA - 積極股債配置",
                annualReturn: 0.0912,
                expense: 0.0015,
                marketCapRank: 1842
            }
        };

        let chart;

        document.getElementById('etfSelect').addEventListener('change', function() {
            const selectedETF = this.value;
            document.getElementById('etfDescription').textContent = '';
        });

        document.getElementById('investmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const monthlyInvestment = parseFloat(document.getElementById('monthlyInvestment').value);
            const investmentPeriod = parseFloat(document.getElementById('investmentPeriod').value);
            const selectedETF = document.getElementById('etfSelect').value;
            
            const annualReturn = etfData[selectedETF].annualReturn - etfData[selectedETF].expense;
            const monthlyRate = annualReturn / 12;
            const totalMonths = investmentPeriod * 12;
            
            const futureValue = monthlyInvestment * ((Math.pow(1 + monthlyRate, totalMonths) - 1) / monthlyRate) * (1 + monthlyRate);
            
            const totalInvested = monthlyInvestment * totalMonths;
            const interestEarned = futureValue - totalInvested;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                選擇的ETF: ${etfData[selectedETF].name}<br>
                投資總額: ${totalInvested.toLocaleString()} 新台幣<br>
                預估收益: ${interestEarned.toLocaleString()} 新台幣<br>
                最終金額: ${futureValue.toLocaleString()} 新台幣
            `;

            updateChart(totalMonths, monthlyInvestment, monthlyRate);
        });

        function updateChart(totalMonths, monthlyInvestment, monthlyRate) {
            const labels = [];
            const investedData = [];
            const totalValueData = [];

            let invested = 0;
            let totalValue = 0;

            for (let month = 0; month <= totalMonths; month++) {
                labels.push(month);
                invested = monthlyInvestment * month;
                investedData.push(invested);

                if (month === 0) {
                    totalValue = 0;
                } else {
                    totalValue = (totalValue + monthlyInvestment) * (1 + monthlyRate);
                }
                totalValueData.push(totalValue);
            }

            const ctx = document.getElementById('investmentChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '投資總額',
                        data: investedData,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        fill: false
                    }, {
                        label: '投資價值',
                        data: totalValueData,
                        borderColor: 'rgba(153, 102, 255, 1)',
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '月數'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '金額 (新台幣)'
                            },
                            ticks: {
                                callback: function(value, index, values) {
                                    return value.toLocaleString() + ' 元';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 填充ETF比較表格
        function populateETFTable() {
            const tableBody = document.querySelector('#etfComparison tbody');
            for (const [key, value] of Object.entries(etfData)) {
                const row = tableBody.insertRow();
                row.insertCell(0).textContent = key;
                row.insertCell(1).textContent = value.name;
                row.insertCell(2).textContent = (value.expense * 100).toFixed(2) + '%';
                row.insertCell(3).textContent = value.marketCapRank;
            }
        }

        // 頁面加載時填充表格
        window.onload = function() {
            populateETFTable();
        };
    </script>
</body>
</html>
