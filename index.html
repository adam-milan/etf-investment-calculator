<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美股ETF定期定額投資計算器</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="number"], select, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #result, #etfDescription {
            margin-top: 20px;
            font-weight: bold;
        }
        #chartContainer {
            margin-top: 20px;
        }
        #notes {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>美股ETF定期定額投資計算器</h1>
        <form id="investmentForm">
            <label for="monthlyInvestment">每月投資金額 (新台幣):</label>
            <input type="number" id="monthlyInvestment" required>
            
            <label for="investmentPeriod">投資期間 (年):</label>
            <input type="number" id="investmentPeriod" required>
            
            <label for="etfSelect">選擇ETF:</label>
            <select id="etfSelect">
                <option value="VTI">VTI - Vanguard Total Stock Market ETF</option>
                <option value="QQQ">QQQ - Invesco QQQ Trust</option>
                <option value="VT">VT - Vanguard Total World Stock ETF</option>
                <option value="AOA">AOA - iShares Core Aggressive Allocation ETF</option>
            </select>
            
            <button type="submit">計算</button>
        </form>
        <div id="etfDescription"></div>
        <div id="result"></div>
        <div id="chartContainer">
            <canvas id="investmentChart"></canvas>
        </div>
        <div id="notes">
            <h3>備註</h3>
            <textarea id="notesText" rows="4" placeholder="在此輸入您的備註..."></textarea>
        </div>
    </div>

    <script>
        const etfData = {
            VTI: {
                name: "Vanguard Total Stock Market ETF",
                description: "VTI-全美國指數",
                annualReturn: 0.1023, // 10.23% average annual return
                expense: 0.0003 // 0.03% expense ratio
            },
            QQQ: {
                name: "Invesco QQQ Trust",
                description: "QQQ-納斯達克100指數",
                annualReturn: 0.1568, // 15.68% average annual return
                expense: 0.0020 // 0.20% expense ratio
            },
            VT: {
                name: "Vanguard Total World Stock ETF",
                description: "VT-全球股市指數",
                annualReturn: 0.0943, // 9.43% average annual return
                expense: 0.0007 // 0.07% expense ratio
            },
            AOA: {
                name: "iShares Core Aggressive Allocation ETF",
                description: "AOA-進取型配置ETF",
                annualReturn: 0.0912, // 9.12% average annual return
                expense: 0.0015 // 0.15% expense ratio
            }
        };

        let chart;

        document.getElementById('etfSelect').addEventListener('change', function() {
            const selectedETF = this.value;
            document.getElementById('etfDescription').textContent = etfData[selectedETF].description;
        });

        document.getElementById('investmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const monthlyInvestment = parseFloat(document.getElementById('monthlyInvestment').value);
            const investmentPeriod = parseFloat(document.getElementById('investmentPeriod').value);
            const selectedETF = document.getElementById('etfSelect').value;
            
            const annualReturn = etfData[selectedETF].annualReturn - etfData[selectedETF].expense;
            const monthlyRate = annualReturn / 12;
            const totalMonths = investmentPeriod * 12;
            
            const futureValue = monthlyInvestment * ((Math.pow(1 + monthlyRate, totalMonths) - 1) / monthlyRate) * (1 + monthlyRate);
            
            const totalInvested = monthlyInvestment * totalMonths;
            const interestEarned = futureValue - totalInvested;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                選擇的ETF: ${etfData[selectedETF].name}<br>
                投資總額: ${totalInvested.toLocaleString()} 新台幣<br>
                預估收益: ${interestEarned.toLocaleString()} 新台幣<br>
                最終金額: ${futureValue.toLocaleString()} 新台幣
            `;

            updateChart(totalMonths, monthlyInvestment, monthlyRate);
        });

        function updateChart(totalMonths, monthlyInvestment, monthlyRate) {
            const labels = [];
            const investedData = [];
            const totalValueData = [];

            let invested = 0;
            let totalValue = 0;

            for (let month = 0; month <= totalMonths; month++) {
                labels.push(month);
                invested = monthlyInvestment * month;
                investedData.push(invested);

                if (month === 0) {
                    totalValue = 0;
                } else {
                    totalValue = (totalValue + monthlyInvestment) * (1 + monthlyRate);
                }
                totalValueData.push(totalValue);
            }

            const ctx = document.getElementById('investmentChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '投資總額',
                        data: investedData,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        fill: false
                    }, {
                        label: '投資價值',
                        data: totalValueData,
                        borderColor: 'rgba(153, 102, 255, 1)',
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '月數'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '金額 (新台幣)'
                            },
                            ticks: {
                                callback: function(value, index, values) {
                                    return value.toLocaleString() + ' 元';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 初始顯示第一個ETF的描述
        document.getElementById('etfDescription').textContent = etfData[document.getElementById('etfSelect').value].description;
    </script>
</body>
</html>
